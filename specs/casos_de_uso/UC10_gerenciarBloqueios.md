| Caso de uso         | UC10 Gerenciar Bloqueios e Agendamentos Administrativos                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| ------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **Objetivo** | Permitir que o Administrador CEF realize reservas diretas (bloqueios) ou exclua qualquer agendamento, e permitir que o Moderador DCE exclua agendamentos de alunos (exceto aulas curriculares). |
| **Requisitos** | **RF012** (Criar bloqueio), **RF013** (Aplicar flags), **RF014** (Exclusão CEF), **RF015** (Exclusão DCE), **RF019** (Notificação) e **RF023** (Log de auditoria). |
| **Atores** | Administrador CEF (Poder Geral) e Moderador DCE (Poder Restrito). |
| **Condição de entrada** | O ator deve estar autenticado com perfil de Administrador CEF ou Moderador DCE. |
| **Fluxo principal (Criação - Exclusivo CEF)** | 1. O **Administrador CEF** acede ao calendário administrativo. <br> 2. O ator identifica um horário vago e seleciona a opção "Novo Bloqueio Administrativo". <br> 3. O sistema solicita o espaço esportivo, data, intervalo de horário e a **Flag** (Aula Curricular, Manutenção, Projeto de Ensino ou Evento Externo). <br> 4. O Administrador CEF confirma a criação. <br> 5. O sistema regista o bloqueio, grava o log de auditoria (**RF023**) e apresenta a mensagem **[MSG10]**. |
| **Fluxos alternativos** | **A1 - Exclusão por Administrador CEF ([RF014])**: <br> 1. O **Administrador CEF** seleciona qualquer horário ocupado (seja de aluno ou bloqueio administrativo). <br> 2. O ator seleciona "Excluir Agendamento". <br> 3. O sistema solicita obrigatoriamente uma justificativa. <br> 4. O Administrador CEF confirma. <br> 5. O sistema remove o item, liberta o horário e notifica o responsável (**RF019**). <br> **A2 - Exclusão por Moderador DCE ([RF015])**: <br> 1. O **Moderador DCE** seleciona um horário ocupado por um aluno. <br> 2. O ator seleciona "Excluir Agendamento". <br> 3. O sistema valida se o horário **não** possui a flag "Aula Curricular" (RN1). <br> 4. O sistema solicita a justificativa. <br> 5. O Moderador DCE confirma. <br> 6. O sistema remove o agendamento e notifica o aluno (**RF019**). |
| **Fluxos de Exceção** | **E1 - Tentativa de Exclusão Proibida (DCE)**: <br> 1. O Moderador DCE tenta excluir um horário marcado como "Aula Curricular". <br> 2. O sistema bloqueia a ação, exibe a mensagem de erro **[MSG04]** e informa que apenas a CEF pode gerir esta categoria. <br> **E2 - Sobrescrita de Horário na Criação**: <br> 1. O Administrador CEF cria um bloqueio sobre uma reserva de aluno. <br> 2. O sistema alerta sobre o conflito e o Administrador confirma a sobrescrita; o sistema cancela a reserva anterior e notifica o aluno. |
| **Regras de Negócio** | **RN1 - Distinção de Poderes** <br> O **Administrador CEF** detém poder total sobre o calendário, podendo criar bloqueios e excluir qualquer reserva (incluindo aulas e projetos). O **Moderador DCE** atua apenas na gestão de agendamentos de alunos, sendo estritamente proibido de excluir ou alterar horários com a flag "Aula Curricular". <br><br> **RN2 - Rastreabilidade (Auditoria)** <br> Todas as criações e exclusões administrativas devem gerar um log (**RF023**) contendo: Ator responsável, Data/Hora da ação e a Justificativa inserida. |
